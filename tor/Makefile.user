install: DESTDIR = /tmp/tor-0.2.7.6


centos-dep:
	#sudo yum install -y libevent-devel openssl-devel systemd-devel zlib-devel
	sudo yum install -y libevent-devel systemd-devel zlib-devel

config:
	sh configure --with-tor-user=_tor --with-tor-group=_tor \
		--prefix=/usr/local/stow/tor --localstatedir=/var --sysconfdir=/usr/local/etc \
		--enable-systemd --enable-coverage
install:
	id -u _tor || sudo useradd -d /usr/local/etc/tor -r -s /sbin/nologin -U _tor
	- mkdir -p /usr/local/stow/tor/etc
	sudo $(MAKE) install
	[ -f /usr/local/etc/tor/torrc ] && sudo cp -Ru -T /usr/local/etc/tor /usr/local/stow/tor/etc/tor
	@ echo Config left in /usr/local/etc/tor
	#$(MAKE) DESTDIR=$(DESTDIR) install
	#mv $(DESTDIR)/usr/local/etc $(DESTDIR)/usr/local/stow/tor/etc
	#DESTDIR=$(DESTDIR) bash -x my-install.sh
post-install:
	sudo bash -x var-dirs.sh
	sudo bash -x centos-firewall.sh
